!function(){"use strict";var t={652:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.Corolla=void 0;var n=o(26),i=o(61),r=function(){function t(){this.position={x:0,y:0},this.resetPetalColors(),this.attachedPetals=this.computePetals(10),this.floatingPetals=[],this.outline=t.computeOutline(40,20),this.noise=new n.Noise(n.Noise.randomInRange(1,2))}return t.prototype.update=function(t){if(this.attachedPetals.length>0&&Math.random()<.1*t){var e=this.attachedPetals.pop();this.registerFloatingPetal(e)}for(var o=0,n=this.floatingPetals;o<n.length;o++){var r=n[o];r.center.y-=.05*r.petalArea*t,r.orientation+=r.rotationSpeed*t}this.trimFloatingPetals(),this.wind=this.noise.compute(t),this.wind.x=1e4*i.Parameters.wind*(this.wind.x-.5),this.wind.y=1e3*(this.wind.y-.5)},t.prototype.draw=function(t){this.drawOutline(t),this.drawPetals(t)},t.prototype.getAcceleration=function(t){var e={x:0,y:0};e.x+=this.wind.x*Math.min(1,this.attachedPetals.length/16),e.y+=this.wind.y;var o=[7e3,1e4,11e3,12e3];e.y+=1e4-o[Math.min(o.length-1,this.attachedPetals.length)];var n=t.computeForce(this.position);return e.x+=2e3*n.x,e.y+=2e3*n.y,e},t.prototype.isDead=function(t){return this.attachedPetals.length<=0&&this.floatingPetals.length<=0&&this.position.y>t+50},t.prototype.resetPetalColors=function(){var t,e,o=i.Parameters.singlePetalColor?i.Parameters.petalColor:(t=n.Noise.randomInRange(0,3),e=Math.floor(t%1*127.5),t<1?{r:255,g:0,b:255-e}:t<2?{r:255,g:e,b:0}:t<3?{r:255-e,g:255,b:0}:t<4?{r:0,g:255,b:e}:t<5?{r:0,g:255-e,b:255}:{r:e,g:0,b:255});this.color="rgba("+o.r+", "+o.g+", "+o.b+", 0.2)"},t.prototype.drawPetals=function(t){var e=this.attachedPetals.concat(this.floatingPetals);t.drawEllipsis(e,this.color)},t.prototype.drawOutline=function(t){t.drawPolygon(this.outline,this.position,i.Parameters.linesColor,i.Parameters.backgroundColor)},t.prototype.trimFloatingPetals=function(){for(var t=this.floatingPetals.length-1;t>=0;t--)this.floatingPetals[t].center.y+.5*Math.max(this.floatingPetals[t].width,this.floatingPetals[t].height)<0&&(this.floatingPetals.splice(t,1),t--)},t.prototype.registerFloatingPetal=function(t){var e=t;e.center={x:this.position.x,y:this.position.y},e.petalArea=e.width*e.height,e.rotationSpeed=n.Noise.randomInRange(-1.5,1.5),this.floatingPetals.push(e)},t.prototype.computePetals=function(t){for(var e=[],o=0;o<t;o++){var i=n.Noise.randomInRange(50,70),r=n.Noise.randomInRange(.3,.7)*i,s=n.Noise.randomInRange(0,2*Math.PI);e.push({width:i,height:r,orientation:s,center:this.position})}return e},t.computeOutline=function(t,e){for(var o=[],i=0;i<t;i++){var r=2*Math.PI*i/(t-1),s=e*n.Noise.randomInRange(1,1.3);o.push({x:s*Math.cos(r),y:s*Math.sin(r)})}return o},t}();e.Corolla=r},481:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.Flower=void 0;var n=o(652),i=o(61),r=o(661),s=function(){function t(e,o){this.attachPoint=e;var i=Math.max(o/t.maxSegmentLength);this.stem=new r.Rope(e,o/i,i),this.corolla=new n.Corolla,this.attachCorolla()}return t.prototype.update=function(t,e){this.corolla.update(t);var o=this.corolla.getAcceleration(e);this.stem.dampening=i.Parameters.dampening,this.stem.update(t,this.attachPoint,o),this.attachCorolla()},t.prototype.getDrawableStem=function(){return this.stem.getDrawableLine(5)},t.prototype.drawCorolla=function(t){this.corolla.draw(t)},t.prototype.isDead=function(t){return this.corolla.isDead(t)&&this.stem.highestPoint>=t},t.prototype.resetPetalColors=function(){this.corolla.resetPetalColors()},t.prototype.attachCorolla=function(){this.corolla.position.x=this.stem.endPosition.x,this.corolla.position.y=this.stem.endPosition.y},t.maxSegmentLength=20,t}();e.Flower=s},410:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.FlowersManager=void 0;var n=o(481),i=o(26),r=o(61),s=function(){function t(){this.flowers=[]}return t.prototype.reset=function(){this.flowers.length=0},t.prototype.manage=function(e,o){for(var n=Math.round(e*r.Parameters.flowersDensity);this.flowers.length<n;){var i=t.createFlower(e,o);this.flowers.push(i)}for(var s=this.flowers.length-1;s>=0;s--)this.flowers[s].isDead(o)&&(this.flowers.length>n?(this.flowers.splice(s,1),s--):this.flowers[s]=t.createFlower(e,o))},t.prototype.update=function(t,e){for(var o=0,n=this.flowers;o<n.length;o++)n[o].update(t,e)},t.prototype.draw=function(t){for(var e=[],o=0,n=this.flowers;o<n.length;o++){var i=n[o];e.push(i.getDrawableStem())}t.drawLines(e,r.Parameters.linesColor);for(var s=0,a=this.flowers;s<a.length;s++)(i=a[s]).drawCorolla(t)},t.prototype.resetPetalColors=function(){for(var t=0,e=this.flowers;t<e.length;t++)e[t].resetPetalColors()},t.createFlower=function(t,e){var o={x:t*Math.random(),y:e},r=i.Noise.randomInRange(.2,.8)*e;return new n.Flower(o,r)},t}();e.FlowersManager=s},255:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.ForceField=void 0;var n=o(61),i=function(){function t(t,e){this.mousePosition=t,this.maxInfluenceDistance=e,this.fleeMouseEnabled=n.Parameters.fleeMouse}return t.prototype.computeForce=function(t){if(!this.fleeMouseEnabled)return{x:0,y:0};var e=t.x-this.mousePosition.x,o=t.y-this.mousePosition.y,n=Math.sqrt(e*e+o*o);if(n>this.maxInfluenceDistance)return{x:0,y:0};var i=.5+Math.cos(Math.PI*n/this.maxInfluenceDistance);return{x:i*i*e/n,y:i*i*o/n}},t}();e.ForceField=i},747:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.downloadTextFile=void 0,e.downloadTextFile=function(t,e){var o="text/plain",n=new Blob([e],{type:o});if(void 0!==window.navigator&&void 0!==window.navigator.msSaveBlob)window.navigator.msSaveBlob(n,t);else{var i=URL.createObjectURL(n),r=document.createElement("a");r.download=t,r.href=i,r.dataset.downloadurl=o+":"+r.download+":"+r.href,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout((function(){URL.revokeObjectURL(i)}),5e3)}}},26:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Noise=void 0;var o=function(){function t(e){this.period=e,this.time=0,this.last={x:0,y:0},this.next={x:0,y:0},this.last=t.randomVector(),this.next=t.randomVector()}return t.prototype.compute=function(e){this.time+=e,this.time>this.period&&(this.last=this.next,this.next=t.randomVector(),this.time=this.time%this.period);var o=this.time/this.period;return{x:this.last.x*(1-o)+this.next.x*o,y:this.last.y*(1-o)+this.next.y*o}},t.randomInRange=function(t,e){return t+(e-t)*Math.random()},t.randomVector=function(){return{x:Math.random(),y:Math.random()}},t}();e.Noise=o},457:function(){},61:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.Parameters=void 0,o(457);var n="single-petal-color-checkbox-id",i="petal-color-id";function r(t){for(var e=0,o=t;e<o.length;e++)(0,o[e])()}var s=[],a=[],h=[],l=function(){function t(){}return Object.defineProperty(t,"mousePositionInPixels",{get:function(){var t=Page.Canvas.getMousePosition();if(2===t.length){var e=Page.Canvas.getSize();return{x:e[0]*t[0],y:e[1]*t[1]}}return{x:0,y:0}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"flowersDensity",{get:function(){return.25*Page.Range.getValue("flowers-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"wind",{get:function(){return Page.Range.getValue("wind-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"speed",{get:function(){return Page.Range.getValue("speed-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"dampening",{get:function(){return 1-.01*Page.Range.getValue("dampening-range-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fleeMouse",{get:function(){return Page.Checkbox.isChecked("flee-mouse-checkbox-id")},enumerable:!1,configurable:!0}),t.addResetObserver=function(t){s.push(t)},Object.defineProperty(t,"backgroundColor",{get:function(){return Page.ColorPicker.getValueHex("background-color-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"linesColor",{get:function(){return Page.ColorPicker.getValueHex("lines-color-id")},enumerable:!1,configurable:!0}),Object.defineProperty(t,"singlePetalColor",{get:function(){return Page.Checkbox.isChecked(n)},enumerable:!1,configurable:!0}),Object.defineProperty(t,"petalColor",{get:function(){return Page.ColorPicker.getValue(i)},enumerable:!1,configurable:!0}),t.addPetalColorChange=function(t){h.push(t)},t.addDownloadObserver=function(t){a.push(t)},t}();function c(){var t=Page.Checkbox.isChecked(n);Page.Controls.setVisibility(i,t)}e.Parameters=l,Page.Checkbox.addObserver(n,c),c(),Page.Button.addObserver("reset-button-id",(function(){r(s)})),Page.Button.addObserver("download-button-id",(function(){r(a)})),Page.Checkbox.addObserver(n,(function(){r(h)})),Page.ColorPicker.addObserver(i,(function(){l.singlePetalColor&&r(h)}))},643:function(t,e,o){function n(t,e,o,n){this.arc(t,e,Math.max(o,n),0,2*Math.PI)}Object.defineProperty(e,"__esModule",{value:!0}),e.PlotterCanvas2D=void 0,o(457);var i=function(){function t(){var t;this.canvas=Page.Canvas.getCanvas(),this.context=this.canvas.getContext("2d",{alpha:!1}),this.cssPixel=null!==(t=window.devicePixelRatio)&&void 0!==t?t:1}return t.prototype.adjustToCanvas=function(){var t=Math.floor(this.cssPixel*this.canvas.clientWidth),e=Math.floor(this.cssPixel*this.canvas.clientHeight);this.canvas.width===t&&this.canvas.height===e||(this.canvas.width=t,this.canvas.height=e),this._width=this.canvas.clientWidth,this._height=this.canvas.clientHeight},t.prototype.initialize=function(t){this.context.fillStyle=t,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.finalize=function(){},t.prototype.drawLines=function(t,e){if(t.length>=1){this.context.strokeStyle=e,this.context.lineWidth=1,this.context.beginPath();for(var o=0,n=t;o<n.length;o++){var i=n[o];if(i.length>=2){this.context.moveTo(i[0].x*this.cssPixel,i[0].y*this.cssPixel);for(var r=1;r<i.length;r++)this.context.lineTo(i[r].x*this.cssPixel,i[r].y*this.cssPixel)}}this.context.stroke(),this.context.closePath()}},t.prototype.drawPolygon=function(t,e,o,n){if(t.length>=2){this.context.strokeStyle=o,this.context.fillStyle=n,this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo((t[0].x+e.x)*this.cssPixel,(t[0].y+e.y)*this.cssPixel);for(var i=1;i<t.length;i++)this.context.lineTo((t[i].x+e.x)*this.cssPixel,(t[i].y+e.y)*this.cssPixel);this.context.closePath(),this.context.fill(),this.context.stroke()}},t.prototype.drawEllipsis=function(t,e){this.context.fillStyle=e,"function"!=typeof this.context.ellipse&&(this.context.ellipse=n);for(var o=0,i=t;o<i.length;o++){var r=i[o];this.context.beginPath(),this.context.ellipse(r.center.x*this.cssPixel,r.center.y*this.cssPixel,.5*r.width*this.cssPixel,.5*r.height*this.cssPixel,r.orientation,0,2*Math.PI),this.context.fill(),this.context.closePath()}},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t}();e.PlotterCanvas2D=i},493:function(t,e,o){Object.defineProperty(e,"__esModule",{value:!0}),e.PlotterSvg=void 0,o(457);var n=function(){function t(t,e){this.stringParts=[],this.width=t,this.height=e}return t.prototype.initialize=function(t){this.stringParts.push('<?xml version="1.0" encoding="UTF-8" standalone="no"?>'),this.stringParts.push('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 '+this.width+" "+this.height+'">'),this.stringParts.push('\t<rect fill="'+t+'" stroke="none" x="0" y="0" width="'+this.width+'" height="'+this.height+'"/>')},t.prototype.finalize=function(){this.stringParts.push("</svg>")},t.prototype.toString=function(){return this.stringParts.join("\n")},t.prototype.drawLines=function(t,e){if(t.length>=1){this.stringParts.push('\t<g stroke="'+e+'" stroke-width="1" fill="none">');for(var o=0,n=t;o<n.length;o++){var i=n[o];i.length>=2&&this.stringParts.push('\t\t<path d="'+this.computePath(i)+'"/>')}this.stringParts.push("\t</g>")}},t.prototype.drawPolygon=function(t,e,o,n){if(t.length>=2){var i="translate("+e.x.toFixed(1)+" "+e.y.toFixed(1)+")";this.stringParts.push('\t<path d="'+this.computePath(t)+'Z" stroke="'+o+'" stroke-width="1" fill="'+n+'" transform="'+i+'"/>')}},t.prototype.drawEllipsis=function(t,e){if(t.length>=1){this.stringParts.push('\t<g stroke="none" fill="'+e+'">');for(var o=0,n=t;o<n.length;o++){var i=n[o],r="translate("+i.center.x.toFixed(1)+" "+i.center.y.toFixed(1)+") rotate("+(s=i.orientation,180*s/Math.PI).toFixed(1)+")";this.stringParts.push('\t\t<ellipse cx="0" cy="0" rx="'+(.5*i.width).toFixed(1)+'" ry="'+(.5*i.height).toFixed(1)+'" transform="'+r+'"/>')}this.stringParts.push("\t</g>")}var s},t.prototype.computePath=function(t){for(var e="M"+t[0].x.toFixed(1)+","+t[0].y.toFixed(1)+"L",o=[],n=1;n<t.length;n++)o.push(t[n].x.toFixed(1)+","+t[n].y.toFixed(1));return e+o.join(" ")},t}();e.PlotterSvg=n},661:function(t,e){function o(t,e){return{pos:{x:t,y:e},previousPos:{x:t,y:e},acc:{x:0,y:0}}}Object.defineProperty(e,"__esModule",{value:!0}),e.Rope=void 0;var n=function(){function t(t,e,n){this.dampening=1,this.segmentLength=e,this.totalLength=e*n,this.nodes=[],this.nodes.push(o(t.x,t.y));for(var i=0;i<n;i++){var r=2*Math.PI*Math.random();this.nodes.push(o(this.nodes[this.nodes.length-1].pos.x+e*Math.cos(r),this.nodes[this.nodes.length-1].pos.y+Math.abs(e*Math.sin(r))))}}return t.prototype.getDrawableLine=function(t){return this.computeSmoothLine(this.totalLength/t)},t.prototype.update=function(t,e,o){this.applyForces(o),this.applyVerlet(t);for(var n=0;n<8;n++)this.applyConstraints(e)},Object.defineProperty(t.prototype,"endPosition",{get:function(){return this.nodes[this.nodes.length-1].pos},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"highestPoint",{get:function(){for(var t=1e6,e=0,o=this.nodes;e<o.length;e++){var n=o[e];n.pos.y<t&&(t=n.pos.y)}return t},enumerable:!1,configurable:!0}),t.prototype.applyForces=function(t){for(var e=1;e<this.nodes.length;e++)this.nodes[e].acc.x=0,this.nodes[e].acc.y=0;this.nodes[this.nodes.length-1].acc.x+=t.x,this.nodes[this.nodes.length-1].acc.y+=t.y},t.prototype.applyVerlet=function(t){for(var e=0,o=this.nodes;e<o.length;e++){var n=o[e],i=n.pos.x+this.dampening*(n.pos.x-n.previousPos.x)+t*t*n.acc.x,r=n.pos.y+this.dampening*(n.pos.y-n.previousPos.y)+t*t*n.acc.y;n.previousPos.x=n.pos.x,n.previousPos.y=n.pos.y,n.pos.x=i,n.pos.y=r}},t.prototype.applyConstraints=function(t){this.nodes[0].pos.x=t.x,this.nodes[0].pos.y=t.y;for(var e=1;e<this.nodes.length;e++){var o=this.nodes[e].pos.x-this.nodes[e-1].pos.x,n=this.nodes[e].pos.y-this.nodes[e-1].pos.y,i=Math.sqrt(o*o+n*n),r=.5*(1-this.segmentLength/(i+1e-6)),s=o*r,a=n*r;this.nodes[e].pos.x-=s,this.nodes[e].pos.y-=a,this.nodes[e-1].pos.x+=s,this.nodes[e-1].pos.y+=a}},t.prototype.computeSmoothLine=function(e){for(var o=[],n=0,i=this.nodes;n<i.length;n++){var r=i[n];o.push(r.pos)}for(;o.length<e;)o=t.subdivideLine(o,.333);return o},t.subdivideLine=function(t,e){var o=[];o.push(t[0]);for(var n=0;n<t.length-1;n++)o.push({x:t[n].x*(1-e)+t[n+1].x*e,y:t[n].y*(1-e)+t[n+1].y*e}),o.push({x:t[n].x*e+t[n+1].x*(1-e),y:t[n].y*e+t[n+1].y*(1-e)});return o.push(t[t.length-1]),o},t}();e.Rope=n}},e={};function o(n){var i=e[n];if(void 0!==i)return i.exports;var r=e[n]={exports:{}};return t[n](r,r.exports,o),r.exports}!function(){var t=o(410),e=o(255),n=o(747),i=o(61),r=o(643),s=o(493);function a(t,e){e.initialize(i.Parameters.backgroundColor),t.draw(e),e.finalize()}o(457),function(){var o=new r.PlotterCanvas2D,h=new t.FlowersManager;i.Parameters.addResetObserver((function(){h.reset()})),i.Parameters.addDownloadObserver((function(){!function(t,e,o){var i=new s.PlotterSvg(e,o);a(t,i);var r=i.toString();n.downloadTextFile("flowers.svg",r)}(h,o.width,o.height)})),i.Parameters.addPetalColorChange((function(){h.resetPetalColors()}));var l=performance.now();requestAnimationFrame((function t(){var n=performance.now(),r=i.Parameters.speed*Math.min(.016666666666666666,.001*(n-l));l=n,o.adjustToCanvas(),h.manage(o.width,o.height);var s=new e.ForceField(i.Parameters.mousePositionInPixels,500);h.update(r,s),a(h,o),requestAnimationFrame(t)}))}()}()}();
//# sourceMappingURL=main.min.js.map